ace.define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],(function(t,e,o){"use strict";var s,i=function(){function t(t){var e,o,s;this.$editor=t,e=this,o=[],s=!1,this.onAfterExec=function(){s=!1,e.processRows(o),o=[]},this.onExec=function(){s=!0},this.onChange=function(t){s&&(-1==o.indexOf(t.start.row)&&o.push(t.start.row),t.end.row!=t.start.row&&o.push(t.end.row))}}return t.prototype.processRows=function(t){var e,o,s,i,n,r,h,c,l,a;for(this.$inChange=!0,e=[],o=0,s=t.length;o<s;o++)if(i=t[o],!(e.indexOf(i)>-1))for(n=this.$findCellWidthsForBlock(i),r=this.$setBlockCellWidthsToMax(n.cellWidths),h=n.firstRow,c=0,l=r.length;c<l;c++)a=r[c],e.push(h),this.$adjustRow(h,a),h++;this.$inChange=!1},t.prototype.$findCellWidthsForBlock=function(t){for(var e,o,s,i=[],n=t;n>=0&&0!=(e=this.$cellWidthsForRow(n)).length;)i.unshift(e),n--;for(o=n+1,n=t,s=this.$editor.session.getLength();n<s-1&&(n++,0!=(e=this.$cellWidthsForRow(n)).length);)i.push(e);return{cellWidths:i,firstRow:o}},t.prototype.$cellWidthsForRow=function(t){var e,o,s,i,n,r,h=this.$selectionColumnsForRow(t),c=[-1].concat(this.$tabsForRow(t)),l=c.map((function(t){return 0})).slice(1),a=this.$editor.session.getLine(t);for(e=0,o=c.length-1;e<o;e++)s=c[e]+1,i=c[e+1],n=this.$rightmostSelectionInCell(h,i),r=a.substring(s,i),l[e]=Math.max(r.replace(/\s+$/g,"").length,n-s);return l},t.prototype.$selectionColumnsForRow=function(t){var e=[],o=this.$editor.getCursorPosition();return this.$editor.session.getSelection().isEmpty()&&t==o.row&&e.push(o.column),e},t.prototype.$setBlockCellWidthsToMax=function(t){var e,o,s,i,n,r,h,c,l,a,p=!0,u=this.$izip_longest(t);for(i=0,n=u.length;i<n;i++)if((r=u[i]).push)for(r.push(NaN),h=0,c=r.length;h<c;h++){if(l=r[h],p&&(e=h,s=0,p=!1),isNaN(l)){for(o=h,a=e;a<o;a++)t[a][i]=s;p=!0}s=Math.max(s,l)}else console.error(r);return t},t.prototype.$rightmostSelectionInCell=function(t,e){var o,s,i,n=0;if(t.length){for(o=[],s=0,i=t.length;s<i;s++)t[s]<=e?o.push(s):o.push(0);n=Math.max.apply(Math,o)}return n},t.prototype.$tabsForRow=function(t){for(var e,o=[],s=this.$editor.session.getLine(t),i=/\t/g;null!=(e=i.exec(s));)o.push(e.index);return o},t.prototype.$adjustRow=function(t,e){var o,s,i,n,r,h,c,l,a,p,u,f=this.$tabsForRow(t);if(0!=f.length)for(o=0,s=-1,n=0,r=(i=this.$izip(e,f)).length;n<r;n++)h=i[n][0],c=i[n][1],0!=(l=(s+=1+h)-(c+=o))&&(p=(a=this.$editor.session.getLine(t).substr(0,c)).replace(/\s*$/g,""),u=a.length-p.length,l>0&&(this.$editor.session.getDocument().insertInLine({row:t,column:c+1},Array(l+1).join(" ")+"\t"),this.$editor.session.getDocument().removeInLine(t,c,c+1),o+=l),l<0&&u>=-l&&(this.$editor.session.getDocument().removeInLine(t,c+l,c),o+=l))},t.prototype.$izip_longest=function(t){var e,o,s,i,n,r,h;if(!t[0])return[];for(e=t[0].length,o=t.length,s=1;s<o;s++)(i=t[s].length)>e&&(e=i);for(n=[],r=0;r<e;r++){for(h=[],s=0;s<o;s++)""===t[s][r]?h.push(NaN):h.push(t[s][r]);n.push(h)}return n},t.prototype.$izip=function(t,e){var o,s,i=t.length>=e.length?e.length:t.length,n=[];for(o=0;o<i;o++)s=[t[o],e[o]],n.push(s);return n},t}();e.ElasticTabstopsLite=i,s=t("../editor").Editor,t("../config").defineOptions(s.prototype,"editor",{useElasticTabstops:{set:function(t){t?(this.elasticTabstops||(this.elasticTabstops=new i(this)),this.commands.on("afterExec",this.elasticTabstops.onAfterExec),this.commands.on("exec",this.elasticTabstops.onExec),this.on("change",this.elasticTabstops.onChange)):this.elasticTabstops&&(this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec),this.commands.removeListener("exec",this.elasticTabstops.onExec),this.removeListener("change",this.elasticTabstops.onChange))}}})})),ace.require(["ace/ext/elastic_tabstops_lite"],(function(t){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=t)}));