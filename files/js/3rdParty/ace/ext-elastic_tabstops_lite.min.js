ace.define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],(function(t,e,s){"use strict";var i,o=function(t){var e,s,i;this.$editor=t,e=this,s=[],i=!1,this.onAfterExec=function(){i=!1,e.processRows(s),s=[]},this.onExec=function(){i=!0},this.onChange=function(t){i&&(-1==s.indexOf(t.start.row)&&s.push(t.start.row),t.end.row!=t.start.row&&s.push(t.end.row))}};(function(){this.processRows=function(t){var e,s,i,o,n,r,h,c,l,a;for(this.$inChange=!0,e=[],s=0,i=t.length;s<i;s++)if(o=t[s],!(e.indexOf(o)>-1))for(n=this.$findCellWidthsForBlock(o),r=this.$setBlockCellWidthsToMax(n.cellWidths),h=n.firstRow,c=0,l=r.length;c<l;c++)a=r[c],e.push(h),this.$adjustRow(h,a),h++;this.$inChange=!1},this.$findCellWidthsForBlock=function(t){for(var e,s,i,o=[],n=t;n>=0&&0!=(e=this.$cellWidthsForRow(n)).length;)o.unshift(e),n--;for(s=n+1,n=t,i=this.$editor.session.getLength();n<i-1&&(n++,0!=(e=this.$cellWidthsForRow(n)).length);)o.push(e);return{cellWidths:o,firstRow:s}},this.$cellWidthsForRow=function(t){var e,s,i,o,n,r,h=this.$selectionColumnsForRow(t),c=[-1].concat(this.$tabsForRow(t)),l=c.map((function(t){return 0})).slice(1),a=this.$editor.session.getLine(t);for(e=0,s=c.length-1;e<s;e++)i=c[e]+1,o=c[e+1],n=this.$rightmostSelectionInCell(h,o),r=a.substring(i,o),l[e]=Math.max(r.replace(/\s+$/g,"").length,n-i);return l},this.$selectionColumnsForRow=function(t){var e=[],s=this.$editor.getCursorPosition();return this.$editor.session.getSelection().isEmpty()&&t==s.row&&e.push(s.column),e},this.$setBlockCellWidthsToMax=function(t){var e,s,i,o,n,r,h,c,l,a,u=!0,f=this.$izip_longest(t);for(o=0,n=f.length;o<n;o++)if((r=f[o]).push)for(r.push(NaN),h=0,c=r.length;h<c;h++){if(l=r[h],u&&(e=h,i=0,u=!1),isNaN(l)){for(s=h,a=e;a<s;a++)t[a][o]=i;u=!0}i=Math.max(i,l)}else console.error(r);return t},this.$rightmostSelectionInCell=function(t,e){var s,i,o,n=0;if(t.length){for(s=[],i=0,o=t.length;i<o;i++)t[i]<=e?s.push(i):s.push(0);n=Math.max.apply(Math,s)}return n},this.$tabsForRow=function(t){for(var e,s=[],i=this.$editor.session.getLine(t),o=/\t/g;null!=(e=o.exec(i));)s.push(e.index);return s},this.$adjustRow=function(t,e){var s,i,o,n,r,h,c,l,a,u,f,p=this.$tabsForRow(t);if(0!=p.length)for(s=0,i=-1,n=0,r=(o=this.$izip(e,p)).length;n<r;n++)h=o[n][0],c=o[n][1],0!=(l=(i+=1+h)-(c+=s))&&(u=(a=this.$editor.session.getLine(t).substr(0,c)).replace(/\s*$/g,""),f=a.length-u.length,l>0&&(this.$editor.session.getDocument().insertInLine({row:t,column:c+1},Array(l+1).join(" ")+"\t"),this.$editor.session.getDocument().removeInLine(t,c,c+1),s+=l),l<0&&f>=-l&&(this.$editor.session.getDocument().removeInLine(t,c+l,c),s+=l))},this.$izip_longest=function(t){var e,s,i,o,n,r,h;if(!t[0])return[];for(e=t[0].length,s=t.length,i=1;i<s;i++)(o=t[i].length)>e&&(e=o);for(n=[],r=0;r<e;r++){for(h=[],i=0;i<s;i++)""===t[i][r]?h.push(NaN):h.push(t[i][r]);n.push(h)}return n},this.$izip=function(t,e){var s,i,o=t.length>=e.length?e.length:t.length,n=[];for(s=0;s<o;s++)i=[t[s],e[s]],n.push(i);return n}}).call(o.prototype),e.ElasticTabstopsLite=o,i=t("../editor").Editor,t("../config").defineOptions(i.prototype,"editor",{useElasticTabstops:{set:function(t){t?(this.elasticTabstops||(this.elasticTabstops=new o(this)),this.commands.on("afterExec",this.elasticTabstops.onAfterExec),this.commands.on("exec",this.elasticTabstops.onExec),this.on("change",this.elasticTabstops.onChange)):this.elasticTabstops&&(this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec),this.commands.removeListener("exec",this.elasticTabstops.onExec),this.removeListener("change",this.elasticTabstops.onChange))}}})})),ace.require(["ace/ext/elastic_tabstops_lite"],(function(t){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=t)}));